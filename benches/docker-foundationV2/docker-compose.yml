version: '3.8'
services:
  postgres:
    image: postgres
    restart: always
    environment:
      POSTGRES_USER: benchmark
      POSTGRES_PASSWORD: password
      POSTGRES_DB: foundation

  bitcoin-core:
    image: ruimarinho/bitcoin-core
    command:
     - server=1
     - listen=1
     - daemon=1
     - rpcuser=Prisca
     - rpcpassword=password
     - rpcallowip=0.0.0.0/0
     - printtoconsole
     - regtest=1

  foundation-server:
    build:
      context: .
      dockerfile: Dockerfile
    restart: always
    depends_on:
      - postgres
      - bitcoin-core
    environment:
      DB_HOST: postgres
      DB_PORT: 5432
      DB_USER: benchmark
      DB_PASSWORD: password
      DB_NAME: foundation
    ports:
      - 3002:3002